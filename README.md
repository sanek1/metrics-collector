# go-musthave-metrics-tpl

Шаблон репозитория для трека «Сервер сбора метрик и алертинга».

## Начало работы

1. Склонируйте репозиторий в любую подходящую директорию на вашем компьютере.
2. В корне репозитория выполните команду `go mod init <n>` (где `<n>` — адрес вашего репозитория на GitHub без префикса `https://`) для создания модуля.

## Сборка приложений

Для удобства сборки приложений с информацией о версии, дате сборки и коммите добавлены специальные скрипты.

### Windows

Для сборки в Windows используйте скрипт `build.bat`. Скрипт автоматически получает информацию о версии из Git-тегов, дату сборки и хеш коммита:

```
build.bat
```

### Linux/macOS

Для сборки в Linux/macOS используйте скрипт `build.sh`. Не забудьте дать права на выполнение:

```
chmod +x build.sh
./build.sh
```

После выполнения скрипта, собранные бинарные файлы будут доступны в директории `bin/`.

### Ручная сборка

Вы также можете собрать приложения вручную, используя следующие команды:

```
go build -o bin/server -ldflags "-X main.buildVersion=v1.0.0 -X main.buildDate=2023-04-06 -X main.buildCommit=abcdef" ./cmd/server
go build -o bin/agent -ldflags "-X main.buildVersion=v1.0.0 -X main.buildDate=2023-04-06 -X main.buildCommit=abcdef" ./cmd/agent
```

## Статический анализ кода

Для запуска статического анализа используйте:

### Windows
```
run-staticlint.bat
```

### Linux/macOS
```
chmod +x run-staticlint.sh
./run-staticlint.sh
```

## Обновление шаблона

Чтобы иметь возможность получать обновления автотестов и других частей шаблона, выполните команду:

```
git remote add -m main template https://github.com/Yandex-Practicum/go-musthave-metrics-tpl.git
```

Для обновления кода автотестов выполните команду:

```
git fetch template && git checkout template/main .github
```

Затем добавьте полученные изменения в свой репозиторий.

## Запуск автотестов

Для успешного запуска автотестов называйте ветки `iter<number>`, где `<number>` — порядковый номер инкремента. Например, в ветке с названием `iter4` запустятся автотесты для инкрементов с первого по четвёртый.

При мёрже ветки с инкрементом в основную ветку `main` будут запускаться все автотесты.

Подробнее про локальный и автоматический запуск читайте в [README автотестов](https://github.com/Yandex-Practicum/go-autotests).
